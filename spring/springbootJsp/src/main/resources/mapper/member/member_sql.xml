<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "HTTP://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 작업공간 MemberXmlSQLMapperInterface -->
<mapper namespace="com.spring.springbootJsp.member.mapper.MemberXmlSQLMapperInterface">
	<!-- id호출 받을 이름 resultType 리턴 자료형 -->
	<select id="getTime" resultType="String"> <!-- getTime호출 시 실행 -->
		<!-- oracle -->
		select sysdate from dual
		<!-- mariadb: select now() from dual -->
	</select>
	
	<!-- 회원 목록 -->
	<!-- resource폴더에 있는 mybatis-config.xml에서 typeAlias태그로 별칭을 설정했을 경우 -->
	<!-- application.properties에서mybatis.type-aliases-package=경로를 성정했을 경우 -->
	<select id="getMemberList" resultType="MemberVO"> <!-- getMemberList 호출 시 실행 -->
		select * from t_member
	</select>
	
	<!-- 회원 조회 -->
	<!-- 전달받는 매개 변수, 반환하는 자료형 -->
	<select id="getMemberView" resultType="com.spring.springbootJsp.member.vo.MemberVO">
		select * from t_member where id = #{id}
	</select>
	
	<!-- 회원 등록 -->
	<!-- 1개 이상 전달받는 매개변수 -->
	<select id="insertMember" parameterType="com.spring.springbootJsp.member.vo.MemberVO">
		insert into t_member (id, pwd, name, email)
				values(#{id}, #{pwd}, #{name}, #{email})
	</select>
	
	<!-- 회원 삭제 -->
	<select id = "deleteMember">
		delete from t_member where id = #{id}
	</select>
	
	<!-- 회원 수정 -->
	<select id = "updateMember" parameterType="com.spring.springbootJsp.member.vo.MemberVO">
		update t_member
		set pwd = #{pwd}, name = #{name}, email = #{email}
		where id = #{id}
	</select>
	
	<!-- 회원 아이디 채크 -->
	<select id="idCheck" resultType="string">
		select decode( count(*), 1, 'true', 'false') as isCheck
		from t_member where id=#{id}
	</select>
	<!-- 여기서 sql문장 끝에 ; 붙이면 안됨! -->
	
	<!-- Mybatis 동적 SQL문 -->
	<!-- select * from t_member where name=#{name} order by joindate desc -->
	<select id="getMemberListIf" resultType="MemberVO">
		select * from t_member
		<where> <!-- if 조건(test결과)에 따라 처리 --> <!-- test == true or false -->
			<if test="name !='' and name != null">name=#{name}</if>
			<if test="email !='' and email != null">and email=#{email}</if>
		</where>
		order by joindate desc
	</select>
	
	
</mapper>